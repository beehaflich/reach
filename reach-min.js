var reach=function(){this.increment_=reach.increment_++};reach.increment_=0;reach.prototype.increment=function(){return this.increment_};reach.callbacks={};reach.prototype.callback=function(a){return arguments.length?(reach.callbacks[this.increment()]=a,this):reach.callbacks[this.increment()]};reach.prototype.url_=null;reach.prototype.url=function(a){return arguments.length?(this.url_=a||null,this):this.url_};
reach.prototype.arguments=function(a){if(arguments.length){this.arguments_=this.arguments_||{};for(var b in a)this.arguments_[b]=a[b];return this}return this.arguments_||{}};reach.stringify=function(a){return window.JSON?window.JSON.stringify(a):null};reach.prototype.stringify=function(a){return reach.stringify(a)};reach.prototype.parameter_="callback";reach.prototype.parameter=function(a){return arguments.length?(this.parameter_=a,this):this.parameter_};
reach.prototype.format=function(a){var b=Object.prototype.toString.call(a);if("[object String]"===b)return b;if("[object Number]"===b){if(Number.isNaN(a))throw"NaN is invalid JSON";if(!Number.isFinite(a))throw"Non-finite numbers are invalid JSON";return a}if("[object Function]"===b)throw"Function is invalid JSON";return this.stringify(a)};reach.prototype.sent_=!1;reach.prototype.sent=function(){return this.sent_};
reach.prototype.send=function(){if(this.sent_)throw"JSONP Request already sent!";var a=this.url();if(!a)throw"URL is required to send a JSONP request";var b=this.arguments(),c;for(c in b)b[c]=this.format(b[c]);this.callback()&&(b[this.parameter()]="reach.callbacks["+this.increment()+"]");var d=[];for(c in b)d.push(encodeURIComponent(c)+"="+encodeURIComponent(b[c]));d.length&&(a=a+"?"+d.join("&"));b=document.head;if(!b)throw"Document seems to have been decapitated (missing <head>)";c=document.createElement("script");
c.type="text/javascript";c.src=a;c.dataset&&(c.dataset.requestSource="reach",c.dataset.increment=this.increment(),c.dataset.timestamp=Math.floor(Date.now()/1E3));b.appendChild(c);this.sent_=!0;return this};
